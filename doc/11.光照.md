# 光照

无光
基础光（环境光）
漫反射
镜面反射


材质


光照贴图
- 镜面反射贴图
- 漫反射贴图

透光物
- 平行光
- 点光源
- 聚光
- 手电筒
- 平滑/软化边缘

多光源
- 定向光
- 点光源
- 合并光源

## 颜色

每个物体都有颜色，我们需要使用数值来表示现实世界中的物体颜色

拓展：
我们看到的颜色，基本就是它反射的颜色，不被吸收的颜色。

颜色的计算值:

```
vec3 light = lightColor * toyColor;
```

两个相乘得到的值就是最终的结果值了。


## 创建光照场景

准备：
- 投光物，使用立体箱子
- 一个物体代表光源

## 步骤

1.我们首先需要一个顶点着色器绘制箱子。和之前的案例一样。
2.需要绘制一个灯或者是立方体，可以和箱子公用一个，可以进行矩阵变换。
3.将光源变为白色， 将物体设置为一种颜色
4.为了不影响等，需要为灯创建一个着色器

上面绘制等的目的就是可以看到灯的位置。

## 基础光照

现实的光收到许多的影响，所有使用简单的模型，有一种交冯氏光照
- 环境 ： 世界上通常也有一些光亮，永远给物体一个颜色
- 漫反射 : 在物体不同方向上现实除不同的效果
- 镜面  ：有光泽物体表面上的亮点。


## 环境光

不是来自于一个光源，来自于周围许多的光。光的属性就是可以向狠毒方向进行发散，从而可以到达不是很临近的点，光可以在一个面上反射，对物体产生影响，叫做全局光照。

我们使用一个很小的光，添加到片段最终颜色中，即使场景中没有直接光源也会发出一些光。

计算公式

```
光颜色 * 环境因子 * 物体颜色 = 最终颜色
void main()
{
    float ambientStrength = 0.1;
    vec3 ambient = ambientStrength * lightColor;

    vec3 result = ambient * objectColor;
    FragColor = vec4(result, 1.0);
}
```

冯氏光照第一部分就算完成了。

## 漫反射

环境光照不可以提供有趣的结果，漫反射可以，距离越近就可以获得更多的光源。

一个光源，我们需要知道它的角度，如果是垂直，那么就会更加的亮

如何测光线与片段的角度？

答：使用法向量的东西，两个向量之间的角度容易通过点乘的方式计算出来。
向量中夹角为0，值为1，反之。

点乘是一个标量：计算光线和片段颜色的影响，不同片段对光的朝向不同，被照亮的也会不同。

- 需要垂直顶点的法向量
- 定向的光线   定向的光线：作为光源的位置与片段的位置之间向量差的方向向量。为了计算这个光线，我们需要光的位置向量和片段的位置向量。


### 法向量

法向量是一个垂直于顶点表面的向量，但是顶点本身并没有表面，利用周围的点计算出一个表面，可以使用x乘岁立方体的所有顶点计算法向量。但是
对于简单的，我们使用手动添加的方式。


### 计算漫反射

我们限制 对每个顶点都有一个法向量，但是仍然需要光的位置和片段的位置向量，光的位置是一个静态位置。

```
void main(){
     gl_Position = projection * view * model * vec4(aPos, 1.0);
    FragPos = vec3(model * vec4(aPos, 1.0));
    Normal = aNormal
}
```

计算光源和向量之间的向量

```
vec3 norm = normalize(Normal);
vec3 lightDir = normalize(lightPos - FragPos);
```

下一步是进行点乘

我们对norm和lightDir向量进行点乘，计算光源对当前片段实际的漫发射影响，结果乘以光的颜色，也就是漫反射的分量。漫反射的角度越大，分量越少。

```
float diff = max(dot(norm,lightDir),0.0);
vec3 fiffuse = diff * lightColor;
```

最后在乘以最后的颜色

```
vec3 result = (ambient + diffuse) * objectColor;
FragColor = vec4(result, 1.0);
```